<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Detection - Linnaeus</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Detection";
    var mkdocs_page_input_path = "detection.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Linnaeus</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../quick_tutorial/">Quick Tutorial</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../basic_types/">Basic Types</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Detection</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#equivalence-detection">Equivalence Detection</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#parse-an-algorithm">Parse an algorithm</a></li>
        
            <li><a class="toctree-l3" href="#detection">Detection</a></li>
        
            <li><a class="toctree-l3" href="#latex-support">LaTeX support</a></li>
        
            <li><a class="toctree-l3" href="#access-state-space-realization-and-transfer-function">Access state-space realization and transfer function</a></li>
        
            <li><a class="toctree-l3" href="#transform-an-algorithm">Transform an algorithm</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../examples/">Examples</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../library/">Algorithm Library</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contributing/">Contributing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../citation/">Citing Linnaeus</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Linnaeus</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Detection</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="equivalence-detection">Equivalence Detection</h1>
<h2 id="parse-an-algorithm">Parse an algorithm</h2>
<p>Suppose an algorithm is already defined and variables, parameters, oracles, and 
update equations are added to the algorithm, the next step is to parse the algorithm. 
Syntax <code>parse</code> is used to translate the input algorithm into a canonical form (transfer function) and use 
the canonical form to perform subsequent analysis such as equivalence detection. 
When parsing an algorithm, the update equations are provided by the system. </p>
<p>With example of gradient descent algorithm, </p>
<p><img src="/Figures/gradient_algo.svg?invert_in_darkmode" align=middle width="130" height="130"/></p>
<p>The following code defines the gradient descent algorithm as <code>algo3</code> and parses it into canonical form. </p>
<pre><code class="python">import linnaeus as lin
from linnaeus import Algorithm

algo3 = Algorithm(&quot;gradient descent algorithm&quot;)
x1 = algo3.add_var(&quot;x1&quot;)
t = algo3.add_parameter(&quot;t&quot;)
gradf = algo3.add_oracle(&quot;gradf&quot;)

algo3.add_update(x1, x1 - t*gradf(x1))
algo3.parse()
</code></pre>

<p><img src="/Figures/gradient_title.svg?invert_in_darkmode" align=middle width="210" height="210"/></p>
<p><img src="/Figures/gradient_eq.svg?invert_in_darkmode" align=middle width="140" height="140"/></p>
<h2 id="detection">Detection</h2>
<p>Linnaeus provides a set of functions to check algorithm equivalence and relations. </p>
<ul>
<li>Oracle equivalence and linear transform, <code>is_equivalent()</code> and <code>test_equivalence()</code> </li>
<li>Permutation, <code>is_permutation()</code> and <code>test_permutation()</code></li>
<li>Repetition, <code>is_repetition()</code> and <code>test_repetition()</code></li>
<li>Conjugation, <code>is_conjugation()</code> and <code>test_conjugation()</code></li>
<li>Duality, <code>is_duality()</code> and <code>test_duality()</code></li>
</ul>
<p>Here is a <a href="https://linnaeus-doc.github.io/#linnaeus">brief description</a> of algorithm equivalence and relations. 
For more details, see <a href="https://arxiv.org/abs/2105.04684">our paper</a>. 
These functions take two arguments, the first one is the target algorithm to parse and the second is the 
reference algorithm or a list of reference algorithms. </p>
<p>For each type of algorithm equivalence or relations, the <code>is_</code> function returns boolean or a list of boolean, simply 
indicating whether the input algorithm and the reference algorithm are equivalent/related or not. The <code>test_</code> function returns more details. 
Specifically, if two algorithms are equivalent/related only when the parameters satisfy a certain condition, the <code>test_</code> function 
will return the condition. </p>
<p>For illustration, we define the triple momentum algorithm as <code>algo4</code> and check oracle equivalence between <code>algo3</code> and <code>algo4</code>. </p>
<p><img src="/Figures/triple_algo.svg?invert_in_darkmode" align=middle width="310" height="310"/></p>
<pre><code class="python">algo4 = Algorithm(&quot;triple momentum algorithm&quot;)
x1, x2, x3 = algo4.add_var(&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;)
alpha, beta, eta = algo4.add_parameter(&quot;alpha&quot;, &quot;beta&quot;, &quot;eta&quot;)
gradf = algo4.add_oracle(&quot;gradf&quot;)

algo4.add_update(x3, x1)
algo4.add_update(x1, (1 + beta)*x1 - beta*x2 - alpha*gradf((1 + eta)*x1 - eta*x2))
algo4.add_update(x2, x3)
algo4.parse()

lin.is_equivalent(algo3, algo4)
</code></pre>

<p><img src="/Figures/triple_title.svg?invert_in_darkmode" align=middle width="210" height="210"/></p>
<p><img src="/Figures/triple_eq.svg?invert_in_darkmode" align=middle width="340" height="340"/></p>
<p>The system returns </p>
<pre><code class="python">True
</code></pre>

<p>To return the conditions for parameters that yield equivalence, we can use the <code>test_equivalent()</code> function as follows.</p>
<pre><code class="python">lin.test_equivalent(algo3, algo4)
</code></pre>

<p><img src="/Figures/parameter.svg?invert_in_darkmode" align=middle width="600" height="600"/></p>
<h4 id="double-check">Double check</h4>
<p>Under very occasional cases, Linnaeus may not be able to identify equivalence and relations between algorithms. 
This is due to limitations of SymPy equation solver. 
In such cases, we recommand users to do double check with the detection functions while exchange the input algorithm 
and the reference algorithm. </p>
<p>For example, the following code shows to do double check for equivalence between <code>algo3</code> and <code>algo4</code>.</p>
<pre><code class="python">lin.is_equivalent(algo3, algo4)
# exchange the input algorithm and the reference algorithm
lin.is_equivalent(algo4, algo3)
</code></pre>

<h4 id="multiple-relations">Multiple relations</h4>
<p>It is possible that algorithms are related with multiple relations. 
In such cases, one algorithm can be transformed into another by sequentially performing 
multiple aforementioned transformations. </p>
<p>Here is an <a href="https://linnaeus-doc.github.io/examples/#check-conjugation-and-permutation-douglas-rachford-splitting-and-admm">example</a> 
to detect conjugation and permutation between Douglas-Rachford splitting and ADMM. 
In this example, Douglas-Rachford splitting can be transformed to ADMM, by performing conjugation and permutation. 
(Since conjugation and permutation commute, the sequence does not matter.)</p>
<p>Linnaeus provides two functions <code>is_conjugate_permutation()</code> and <code>test_conjugate_permutation()</code> 
to detect conjugation and permutation together. 
The input and output for these functions are the same as the aforementioned detection functions. </p>
<h2 id="latex-support">LaTeX support</h2>
<p>We recommand users to use an IPython console that LaTeX is installed to check the parameter maps returned by the <code>test_</code> functions. 
An IPython notebook with LaTeX support is also recommanded. </p>
<h2 id="access-state-space-realization-and-transfer-function">Access state-space realization and transfer function</h2>
<h4 id="state-space-realization">State-space realization</h4>
<p>Function <code>get_ss(verbose)</code> returns the state-space realization of an algorithm. 
If <code>verbose</code> is <code>False</code>, it will return a big matrix containing state-space matrices A, B, C, and D. 
If <code>verbose</code> is <code>True</code>, it will explicitly indicate the A, B, C, and D matrices. 
The default setting of <code>verbose</code> is <code>False</code>.</p>
<p>The following example shows to get the state-space realization of the triple momentum algorithm, <code>algo4</code>.</p>
<pre><code class="python">algo4.get_ss()
</code></pre>

<p><img src="/Figures/whole_ss.svg?invert_in_darkmode" align=middle width="150" height="150"/></p>
<pre><code class="python">algo4.get_ss(verbose = True)
</code></pre>

<p><img src="/Figures/ss_title.svg?invert_in_darkmode" align=middle width="160" height="160"/></p>
<p><img src="/Figures/triple_ss.svg?invert_in_darkmode" align=middle width="350" height="350"/></p>
<p>Specifically, function <code>get_canonical_ss(ss_type, verbose)</code> returns the canonical form of 
the state-space realization. </p>
<p>If <code>ss_type</code> is <code>'c'</code>, it will return the controllable canonical form; 
and if <code>ss_type</code> is <code>'o'</code>, it will return the observable canonical form. 
The default setting is <code>'c'</code>.
More details about controlable and observable canonical forms can be found <a href="https://faculty.washington.edu/chx/teaching/me547/1-6_ss_realization_slides.pdf">here</a>. </p>
<p><code>verbose</code> is the same as function <code>get_ss()</code>. </p>
<p>The following example shows to get the observable canonical form of state-space realization of the triple momentum algorithm, <code>algo4</code>.</p>
<pre><code class="python">algo4.get_canonical_ss(ss_type = 'o', verbose = True)
</code></pre>

<p><img src="/Figures/observable_title.svg?invert_in_darkmode" align=middle width="220" height="220"/></p>
<p><img src="/Figures/observable_ss.svg?invert_in_darkmode" align=middle width="350" height="350"/></p>
<h4 id="transfer-function">Transfer function</h4>
<p>Function <code>get_tf()</code> returns the transfer function of an algorithm.</p>
<p>The following code shows to get the transfer function of the triple momentum algorithm, <code>algo4</code>.</p>
<pre><code class="python">algo4.get_tf()
</code></pre>

<p><img src="/Figures/tf.svg?invert_in_darkmode" align=middle width="130" height="130"/></p>
<h2 id="transform-an-algorithm">Transform an algorithm</h2>
<p>To detect complex relations, Linnaeus provides a set of functions to transform an algorithm. </p>
<ul>
<li><code>permute(step)</code>, returns a permutation of an algorithm with specific steps set by argument <code>step</code>. The default setting of <code>step</code> is 0, which returns the one-step permutation. <code>step</code> should be an integer and less than the total oracle number of the algorithm. </li>
<li><code>conjugate(conjugate_oracle)</code>, returns the conjugate of an algorithm with respect to the specific oracle set by argument <code>conjugate_oracle</code>. The default setting of <code>conjugate_oracle</code> is 0, which returns the conjugate with respect to the first oracle. <code>conjugate_oracle</code> should be an integer and within the set of oracle indices of the algorithm. If an algorithm contains <code>n</code> oracles, its set of oracle indices is <code>[0, ..., n - 1]</code>.</li>
<li><code>dual()</code>, returns the conjugate of an algorithm with respect to all the oracles. </li>
<li><code>repeat(times)</code>, returns a repetition of an algorithm that repeats the algorithm with <code>times</code> of times. The default setting of <code>times</code> is 2, which repeats the algorithm twice. <code>times</code> should be an positive integer. </li>
</ul>
<p>The following code transforms <code>new_algo</code> in different ways. </p>
<pre><code class="python">new_algo.permute()

new_algo.conjugate(1)

new_algo.dual()

new_algo.repeat(3)
</code></pre>

<p>For example, we can get the state-space realization for the permutation of <code>new_algo</code> as follows,</p>
<pre><code class="python">new_algo.permute().get_ss()
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../examples/" class="btn btn-neutral float-right" title="Examples">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../basic_types/" class="btn btn-neutral" title="Basic Types"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../basic_types/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../examples/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
